# 2 - Statistical Analysis
This folder contains scripts used for the statistical analysis of microbiome data, structured into four main areas:


## ‚öôÔ∏è Structure

| Script                         | Description                                                                                                      |
|:-----------------------------:|:-----------------------------------------------------------------------------------------------------------------|
| `1_alpha_beta_diversity.rmd`    | Calculates **alpha diversity** using Shannon and Chao1 indices, and **beta diversity** using Aitchison distance. Statistical comparisons between groups are performed with **PERMANOVA**. |
| `2_differential_abundance_ANCOMBC.rmd` | Performs differential abundance analysis using **ANCOM-BC**, which adjusts for compositional effects and controls false discovery rate. |
| `3_differential_abundance_LINDA.rmd`   | Executes differential abundance testing with **LINDA**, a linear model-based approach suitable for zero-inflated compositional data. |
| `4_lasso_predictive_model.rmd`  | Builds **LASSO regression** models using the `glmnet` package to identify predictive microbial features. Evaluates model performance with **AUC** metrics. |
| `5_functional_analysis_humann.rmd` | Processes functional profiles generated by **HUMAnN3**, normalizes them to **copies per million (CPM)**, and stratifies by taxonomy. Prepares tables for downstream comparisons of functional potential across conditions. |


## `1_alpha_beta_diversity.rmd`  

### üîπ Part 1: Preprocessing Before Diversity Analyses

Prior to calculating diversity metrics, the abundance data is preprocessed to ensure meaningful and comparable results. Different normalization steps are applied depending on whether **alpha** or **beta** diversity is being assessed:

#### ‚û§ Alpha Diversity
For alpha diversity (within-sample diversity), the following step is applied:

- **Rarefaction**: All samples are subsampled to the same sequencing depth to correct for differences in library size. This step allows fair comparison of diversity indices such as Shannon and Chao1 across samples.

#### ‚û§ Beta Diversity
For beta diversity (between-sample differences), the data is preprocessed as follows:

- **Zero filtering**: Taxa with zero counts across all samples are removed to reduce sparsity and noise in the dataset.
- **CLR transformation**: A **Centered Log-Ratio (CLR)** transformation is applied to the count data to handle its compositional nature. This step is essential before computing distances such as the **Aitchison distance**, which requires data in Euclidean space.

These tailored preprocessing steps are essential for ensuring that diversity metrics are both statistically valid and biologically meaningful.

### üîπ Part 2: Diversity Analyses
